<html data-color-mode="light" data-dark-theme="dark" data-light-theme="light">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type" />
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="https://unpkg.com/@wooorm/starry-night@2.1.1/style/both.css" rel="stylesheet" />
<link href="https://unpkg.com/@primer/css@^21.0.7/dist/primer.css" rel="stylesheet" />

</head>
<style>
.markdown-body {
    box-sizing: border-box;
    min-width: 200px;
    max-width: 900px;
    margin: 10px auto;
    padding: 45px;
    font-family: sans-serif;
}
@media (max-width: 560px) {
    .markdown-body { padding: 8px;} 
}

.avatar {transition: 0.8s;}
.avatar:hover {transform: scale(1.15) rotate(360deg);}

h1 {display:flex;}
.title-right{display:flex;margin:auto 0 0 auto;}
.title-right button{margin-left:8px;padding:16px;}
.SideNav{min-width: 360px;}
.SideNav-icon{margin-right: 16px}
#postBody{border-bottom: 1px solid var(--color-border-default);}
#comments{margin-top:64px;}
.footer {margin: 40px auto; text-align: center;font-size: small;}
#cmButton{height:48px;margin-top:48px;}
</style>
<script>var blogBase={"postTitle": "\u68b3\u7406DRF\u7684\u89c6\u56fe(\u96c6)", "postBody": "<p><a href=\"https://docs.python.org/zh-cn/3/index.html\" rel=\"nofollow\"><img src=\"https://camo.githubusercontent.com/f828e2ccbea9602aa54e417311e0d6e96f4719171c0f1051f93857692a8d0ced/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f507974686f6e2d3337373641423f6c6f676f3d707974686f6e266c6f676f436f6c6f723d4646443433422663616368655365636f6e64733d3836343030\" alt=\"Static Badge\" data-canonical-src=\"https://img.shields.io/badge/Python-3776AB?logo=python&amp;logoColor=FFD43B&amp;cacheSeconds=86400\" style=\"max-width: 100%;\"></a> <a href=\"https://docs.djangoproject.com/zh-hans/4.2/\" rel=\"nofollow\"><img src=\"https://camo.githubusercontent.com/9807661716c476dfaaf8c57eb82b42a2bacc19a9494c01cf8460bb3479596247/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f446a616e676f2d3039324532303f6c6f676f3d646a616e676f2663616368655365636f6e64733d3836343030\" alt=\"Django \u6587\u6863\" data-canonical-src=\"https://img.shields.io/badge/Django-092E20?logo=django&amp;cacheSeconds=86400\" style=\"max-width: 100%;\"></a> <a href=\"https://www.django-rest-framework.org/\" rel=\"nofollow\"><img src=\"https://camo.githubusercontent.com/5363d1e5a64fc6a2eebf8a684d12bb31477610ee04d0a12a826aa751efbe4837/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f446a616e676f5f524553545f4672616d65776f726b2d3965303030303f63616368655365636f6e64733d3836343030\" alt=\"Static Badge\" data-canonical-src=\"https://img.shields.io/badge/Django_REST_Framework-9e0000?cacheSeconds=86400\" style=\"max-width: 100%;\"></a></p>\n<p>\u4e3b\u8981\u4e1a\u52a1\u903b\u8f91\u91cd\u5199\u70b9\u96c6\u4e2d\u5728\u8fd9\u51e0\u4e2a\u7c7b\uff0c\u5b83\u4eec\u901a\u8fc7\u5355\u7ee7\u627f\u6765\u6269\u5c55\uff1a</p>\n<ul>\n<li>\n<code>View</code> \u53ea\u63d0\u4f9b\u4e86\u57fa\u672c\u7684\u5c06HTTP\u8bf7\u6c42\u8f6c\u53d1\u5230\u540c\u540d\u7c7b\u65b9\u6cd5\u5904\u7406\u7684\u529f\u80fd\u3002</li>\n<li>\n<code>APIView</code> \u63d0\u4f9b\u4e86\u6807\u5934\u5b9a\u5236\u3001\u6743\u9650\u68c0\u67e5\u3001\u9650\u6d41\u3001\u8bf7\u6c42\u5185\u5bb9\u89e3\u6790\u5b9a\u5236\u3001\u54cd\u5e94\u5185\u5bb9\u5e8f\u5217\u5316\u5b9a\u5236\u3001\u5f02\u5e38\u5904\u7406\u3001\u63a5\u53e3\u7248\u672c\u7ba1\u7406\u7b49\u529f\u80fd\u3002</li>\n<li>\n<code>GenericAPIView</code> \u63d0\u4f9b\u4e86\u67e5\u8be2\u96c6\u3001\u5bf9\u8c61\u3001\u5e8f\u5217\u5316\u5668\u7684\u83b7\u53d6\u63a5\u53e3\uff0c\u4ee5\u53ca\u5206\u9875\u63a5\u53e3\u3002</li>\n</ul>\n<p>\u4ee5\u4e0a\uff0c\u6240\u6709HTTP\u8bf7\u6c42\u90fd\u4f1a\u6309\u7167HTTP\u65b9\u6cd5\u8f6c\u53d1\u7ed9\u540c\u540d\u7c7b\u65b9\u6cd5\u6765\u5904\u7406\u3002<br>\n\u901a\u8fc7\u6df7\u5165 <code>ViewSetMixin</code> \u5141\u8bb8\u4e00\u4e2a\u89c6\u56fe\u7c7b\u5904\u7406\u591a\u4e2a\u540c\u79cdHTTP\u8bf7\u6c42\uff0c\u6bd4\u5982\u5217\u8868\u7684GET\u548c\u8be6\u60c5\u7684GET\u5206\u522b\u8f6c\u53d1\u5230\u81ea\u5b9a\u4e49\u7684 <code>.list()</code> \u548c <code>retrieve()</code> \uff0c\u7ee7\u800c\u884d\u751f\u51fa\u4ee5\u4e0b\u89c6\u56fe\u96c6\u7c7b\uff1a</p>\n<ul>\n<li>\n<code>ViewSet</code> = <code>ViewSetMixin</code> + <code>APIView</code>\n</li>\n<li>\n<code>GenericViewSet</code> = <code>ViewSetMixin</code> + <code>GenericAPIView</code>\n</li>\n</ul>\n<p><code>GenericAPIView</code> \u548c <code>GenericViewSet</code> \u53c8\u53ef\u4ee5\u901a\u8fc7\u6df7\u5165\u4ee5\u4e0b\u51e0\u4e2a\u57fa\u7840\u7684 Mix-in \u884d\u751f\u51fa\u4e00\u5806\u9884\u5236\u7684\u89c6\u56fe\u7c7b\u3002</p>\n<ul>\n<li>\n<code>ListModelMixin</code> \u901a\u8fc7 <code>.list()</code> \u5217\u51fa\u4e00\u4efd\u67e5\u8be2\u96c6\uff0c\u5e76\u8c03\u7528 <code>GenericAPIView</code> \u7684 <code>.paginate_queryset()</code> \u548c <code>.get_paginated_response()</code> \u8fdb\u884c\u5206\u9875\u3002</li>\n<li>\n<code>CreateModelMixin</code> \u901a\u8fc7 <code>.create()</code> \u521b\u5efa\u4e00\u4e2a\u6a21\u578b\u5e76\u8fd4\u56de201\uff0c\u6700\u7ec8\u662f\u901a\u8fc7 <code>.perform_create()</code> \u7528\u5e8f\u5217\u5316\u5668\u521b\u5efa\u3002</li>\n<li>\n<code>RetrieveModelMixin</code> \u901a\u8fc7 <code>.retrieve()</code> \u83b7\u53d6\u4e00\u4e2a\u6a21\u578b\u5b9e\u4f8b\u3002</li>\n<li>\n<code>UpdateModelMixin</code> \u901a\u8fc7 <code>.update()</code> \u5168\u91cf\u66f4\u65b0\u548c <code>.partial_update()</code> \u90e8\u5206\u66f4\u65b0\u4e00\u4e2a\u6a21\u578b\u5b9e\u4f8b\uff0c\u6700\u7ec8\u662f\u901a\u8fc7 <code>.perform_update()</code> \u7528\u5e8f\u5217\u5316\u5668\u66f4\u65b0\u3002</li>\n<li>\n<code>DestroyModelMixin</code> \u901a\u8fc7 <code>.destroy()</code> \u5220\u9664\u4e00\u4e2a\u6a21\u578b\u5b9e\u4f8b\u5e76\u8fd4\u56de\u65e0\u5185\u5bb9\u7684204\uff0c\u6700\u7ec8\u662f\u901a\u8fc7 <code>.perform_destroy()</code> \u76f4\u63a5\u5220\u9664\u6a21\u578b\u5b9e\u4f8b\u3002</li>\n</ul>\n<p>\u4e0b\u9762\u901a\u8fc7\u4e24\u6761\u4e3b\u7ebf\u6765\u6d45\u6790\u89c6\u56fe(\u96c6)\u3002</p>\n<h2><a id=\"user-content-dispatch\u7ebf\" class=\"anchor\" aria-hidden=\"true\" href=\"#dispatch\u7ebf\"><span aria-hidden=\"true\" class=\"octicon octicon-link\"></span></a>dispatch\u7ebf</h2>\n<p>Django \u7684 <code>View</code> \u901a\u8fc7 <code>.dispatch()</code> \u5c06\u63a5\u6536\u5230\u7684 <a href=\"https://docs.djangoproject.com/zh-hans/4.2/ref/request-response/#httprequest-objects\" rel=\"nofollow\"><code>HttpRequest</code></a> \u8f6c\u53d1\u5230HTTP\u540c\u540d\u7c7b\u65b9\u6cd5\u5904\u7406\u5e76\u8fd4\u56de <a href=\"https://docs.djangoproject.com/zh-hans/4.2/ref/request-response/#httpresponse-objects\" rel=\"nofollow\"><code>HttpResponse</code></a> \uff0c\u6d41\u7a0b\u5982\u4ee5\u4e0b\u4ee3\u7801\u6240\u793a\u610f\uff1a</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-k\">from</span> <span class=\"pl-s1\">django</span>.<span class=\"pl-s1\">views</span>.<span class=\"pl-s1\">generic</span>.<span class=\"pl-s1\">base</span> <span class=\"pl-k\">import</span> <span class=\"pl-v\">View</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">MeowView</span>(<span class=\"pl-v\">View</span>):\n\n    <span class=\"pl-c\"># GET \u8bf7\u6c42\u5c06\u88ab\u8f6c\u53d1\u5230\u8fd9\u4e2a\u51fd\u6570\u6765\u5904\u7406</span>\n    <span class=\"pl-k\">def</span> <span class=\"pl-en\">get</span>(<span class=\"pl-s1\">self</span>, <span class=\"pl-s1\">request</span>, <span class=\"pl-c1\">*</span><span class=\"pl-s1\">args</span>, <span class=\"pl-c1\">**</span><span class=\"pl-s1\">kwargs</span>):\n        <span class=\"pl-k\">pass</span>\n\n    <span class=\"pl-c\"># POST \u8bf7\u6c42\u5c06\u88ab\u8f6c\u53d1\u5230\u8fd9\u91cc</span>\n    <span class=\"pl-k\">def</span> <span class=\"pl-en\">post</span>(<span class=\"pl-s1\">self</span>, <span class=\"pl-s1\">request</span>, <span class=\"pl-c1\">*</span><span class=\"pl-s1\">args</span>, <span class=\"pl-c1\">**</span><span class=\"pl-s1\">kwargs</span>):\n        <span class=\"pl-k\">pass</span>\n\n    <span class=\"pl-c\"># OPTIONS\u3001PUT\u3001DELETE \u7b49\u540c\u7406</span></pre></div>\n<p>\u65b9\u6cd5\u7684\u4ee3\u7801\u5927\u81f4\u5982\u4e0b\uff1a</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-c\"># \u7701\u7565\u4e86\u5f88\u591a\u7ec6\u8282...</span>\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">dispatch</span>(<span class=\"pl-s1\">self</span>, <span class=\"pl-s1\">request</span>, <span class=\"pl-c1\">*</span><span class=\"pl-s1\">args</span>, <span class=\"pl-c1\">**</span><span class=\"pl-s1\">kwargs</span>):\n    <span class=\"pl-c\"># \u5c06\u8bf7\u6c42\u8f6c\u53d1\u5230\u540c\u540d\u7c7b\u65b9\u6cd5\u6765\u5904\u7406</span>\n    <span class=\"pl-k\">if</span> <span class=\"pl-s1\">request</span>.<span class=\"pl-s1\">method</span>.<span class=\"pl-en\">lower</span>() <span class=\"pl-c1\">in</span> <span class=\"pl-s1\">self</span>.<span class=\"pl-s1\">http_method_names</span>:\n        <span class=\"pl-s1\">handler</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">getattr</span>(<span class=\"pl-s1\">self</span>, <span class=\"pl-s1\">request</span>.<span class=\"pl-s1\">method</span>.<span class=\"pl-en\">lower</span>(),\n                          <span class=\"pl-s1\">self</span>.<span class=\"pl-s1\">http_method_not_allowed</span>)\n    <span class=\"pl-c\"># \u5982\u679c\u627e\u4e0d\u5230\uff0c\u6216\u8bf7\u6c42\u65b9\u6cd5\u662f\u975e\u6cd5\u7684\uff0c</span>\n    <span class=\"pl-c\"># \u5c31\u8f6c\u5230 self.http_method_not_allowed() \u5904\u7406\u3002</span>\n    <span class=\"pl-k\">else</span>:\n        <span class=\"pl-s1\">handler</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">self</span>.<span class=\"pl-s1\">http_method_not_allowed</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-en\">handler</span>(<span class=\"pl-s1\">request</span>, <span class=\"pl-c1\">*</span><span class=\"pl-s1\">args</span>, <span class=\"pl-c1\">**</span><span class=\"pl-s1\">kwargs</span>)</pre></div>\n<p>DRF \u7684 <code>APIView</code> \u91cd\u8f7d\u4e86 <code>.dispatch()</code>\uff0c\u4e3b\u8981\u4f5c\u7528\u4e0e\u524d\u8005\u4e00\u6837\uff0c\u4f46\u6dfb\u52a0\u4e86</p>\n<ul>\n<li>\n<code>.initialize_request()</code> \u5b9a\u5236\u8bf7\u6c42\u5bf9\u8c61\uff1b</li>\n<li>\n<code>.initial()</code> \u5728\u5904\u7406\u524d\u521d\u59cb\u5316\uff1b</li>\n<li>\u515c\u4f4f\u5904\u7406\u65f6\u7684\u5f02\u5e38\uff0c\u5e76\u4ea4\u7ed9 <code>.handle_exception()</code> \u5904\u7406\uff1b</li>\n<li>\n<code>.finalize_response()</code> \u5b9a\u5236\u54cd\u5e94\u5bf9\u8c61</li>\n</ul>\n<p>\u51e0\u4e2a\u7279\u6027\u3002\u5176\u4ee3\u7801\u5927\u81f4\u5982\u4e0b\uff1a</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-c\"># \u7701\u7565\u4e86\u5f88\u591a\u7ec6\u8282...</span>\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">dispatch</span>(<span class=\"pl-s1\">self</span>, <span class=\"pl-s1\">request</span>, <span class=\"pl-c1\">*</span><span class=\"pl-s1\">args</span>, <span class=\"pl-c1\">**</span><span class=\"pl-s1\">kwargs</span>):\n    <span class=\"pl-c\"># \u521d\u59cb\u5316request\u7684\u4e00\u4e9b\u4e1c\u897f\uff0c\u6bd4\u5982\u8eab\u4efd\u9a8c\u8bc1\u3002</span>\n    <span class=\"pl-s1\">request</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">self</span>.<span class=\"pl-en\">initialize_request</span>(<span class=\"pl-s1\">request</span>, <span class=\"pl-c1\">*</span><span class=\"pl-s1\">args</span>, <span class=\"pl-c1\">**</span><span class=\"pl-s1\">kwargs</span>)\n\n    <span class=\"pl-c\"># \u9644\u52a0\u5230\u5bf9\u8c61\u4e2d\u3002\u5728\u4e0d\u80fd\u6216\u4e0d\u4fbf\u4f20\u53c2\u7684\u5730\u65b9\u4f7f\u7528\u89c6\u56fe\u5bf9\u8c61\u6765\u83b7\u5f97\u5f53\u524d\u8bf7\u6c42\u3002</span>\n    <span class=\"pl-s1\">self</span>.<span class=\"pl-s1\">request</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">request</span>\n\n    <span class=\"pl-k\">try</span>:\n        <span class=\"pl-c\"># \u521d\u59cb\u5316\u3002\u8eab\u4efd\u9a8c\u8bc1\u3001\u6743\u9650\u68c0\u67e5\u3001\u9891\u7387\u9650\u5236\u5c31\u662f\u5728\u8fd9\u91cc\u505a\u7684\u3002</span>\n        <span class=\"pl-c\"># \u53ef\u4ee5\u7ee7\u627f\u91cd\u5199\u6dfb\u52a0\u81ea\u5df1\u7684\u521d\u59cb\u5316\uff0c\u6bd4\u5982\u63a7\u5236\u67e5\u8be2\u96c6\u8303\u56f4\u7b49\u3002</span>\n        <span class=\"pl-s1\">self</span>.<span class=\"pl-en\">initial</span>(<span class=\"pl-s1\">request</span>, <span class=\"pl-c1\">*</span><span class=\"pl-s1\">args</span>, <span class=\"pl-c1\">**</span><span class=\"pl-s1\">kwargs</span>)\n\n        <span class=\"pl-c\"># \u5c06\u8bf7\u6c42\u8f6c\u53d1\u5230\u540c\u540d\u7c7b\u65b9\u6cd5\u6765\u5904\u7406</span>\n        <span class=\"pl-k\">if</span> <span class=\"pl-s1\">request</span>.<span class=\"pl-s1\">method</span>.<span class=\"pl-en\">lower</span>() <span class=\"pl-c1\">in</span> <span class=\"pl-s1\">self</span>.<span class=\"pl-s1\">http_method_names</span>:\n            <span class=\"pl-s1\">handler</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">getattr</span>(<span class=\"pl-s1\">self</span>, <span class=\"pl-s1\">request</span>.<span class=\"pl-s1\">method</span>.<span class=\"pl-en\">lower</span>(),\n                              <span class=\"pl-s1\">self</span>.<span class=\"pl-s1\">http_method_not_allowed</span>)\n        <span class=\"pl-c\"># \u5982\u679c\u627e\u4e0d\u5230\uff0c\u6216\u8bf7\u6c42\u65b9\u6cd5\u662f\u975e\u6cd5\u7684\uff0c</span>\n        <span class=\"pl-c\"># \u5c31\u8f6c\u5230 self.http_method_not_allowed() \u5904\u7406\u3002</span>\n        <span class=\"pl-k\">else</span>:\n            <span class=\"pl-s1\">handler</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">self</span>.<span class=\"pl-s1\">http_method_not_allowed</span>\n        <span class=\"pl-s1\">response</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">handler</span>(<span class=\"pl-s1\">request</span>, <span class=\"pl-c1\">*</span><span class=\"pl-s1\">args</span>, <span class=\"pl-c1\">**</span><span class=\"pl-s1\">kwargs</span>)\n\n    <span class=\"pl-c\"># \u5904\u7406\u5f02\u5e38\u3002\u6ce8\u610f\u8fd9\u91cc\u62e6\u622a\u7684\u662f Exception\uff0c\u50cf KeyboardInterrupt \u8fd9\u4e9b\u662f\u62e6\u622a\u4e0d\u5230\u7684\u3002</span>\n    <span class=\"pl-k\">except</span> <span class=\"pl-v\">Exception</span> <span class=\"pl-k\">as</span> <span class=\"pl-s1\">exc</span>:\n        <span class=\"pl-s1\">response</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">self</span>.<span class=\"pl-en\">handle_exception</span>(<span class=\"pl-s1\">exc</span>)\n\n    <span class=\"pl-c\"># \u6574\u7406response\u3002\u5728\u8fd9\u91cc\u5b9a\u5236\u81ea\u5df1\u9700\u8981\u7684\u8fd4\u56de\u503c\u683c\u5f0f\u3001\u54cd\u5e94\u7801\u7b49\u7b49\u3002</span>\n    <span class=\"pl-s1\">self</span>.<span class=\"pl-s1\">response</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">self</span>.<span class=\"pl-en\">finalize_response</span>(<span class=\"pl-s1\">request</span>, <span class=\"pl-s1\">response</span>, <span class=\"pl-c1\">*</span><span class=\"pl-s1\">args</span>, <span class=\"pl-c1\">**</span><span class=\"pl-s1\">kwargs</span>)\n    <span class=\"pl-k\">return</span> <span class=\"pl-s1\">self</span>.<span class=\"pl-s1\">response</span></pre></div>\n<h2><a id=\"user-content-as_view\u7ebf\" class=\"anchor\" aria-hidden=\"true\" href=\"#as_view\u7ebf\"><span aria-hidden=\"true\" class=\"octicon octicon-link\"></span></a>as_view\u7ebf</h2>\n<p><code>.as_view()</code> \u662f\u5c06\u89c6\u56fe\u7c7b\u7684\u521d\u59cb\u5316\u3001\u6267\u884c\u7b49\u64cd\u4f5c\u5b58\u50a8\u5728\u4e00\u4e2a\u51fd\u6570\u4e2d\uff08\u6709\u70b9\u88c5\u9970\u5668\u90a3\u5473\u513f\uff09\uff0c\u4f9b\u8def\u7531\u8c03\u7528\uff0c\u4e5f\u5c31\u662f\u5904\u7406\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u4e3b\u5165\u53e3\uff08Main entry point for a request-response process.\uff09\u3002</p>\n<p><code>View</code> \u7684 <code>as_view()</code> \u4ee3\u7801\u5927\u81f4\u5982\u4e0b\uff1a</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-c\"># \u7701\u7565\u4e86\u5f88\u591a\u7ec6\u8282...</span>\n<span class=\"pl-en\">@<span class=\"pl-s1\">classonlymethod</span></span>\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">as_view</span>(<span class=\"pl-s1\">cls</span>, <span class=\"pl-c1\">**</span><span class=\"pl-s1\">initkwargs</span>):\n    <span class=\"pl-c\"># \u8fd9\u4e2a initkwargs \u662f\u4e0b\u9762\u7528\u6765\u521d\u59cb\u5316 View \u7684\u53c2\u6570\uff0c</span>\n    <span class=\"pl-c\"># \u952e\u4e0d\u80fd\u662fHTTP\u8bf7\u6c42\u65b9\u6cd5\uff0c\u4e5f\u4e0d\u80fd\u662f View \u6ca1\u6709\u7684\u5c5e\u6027\uff1b</span>\n    <span class=\"pl-c\"># \u800c\u56de\u770b View \u53d1\u73b0 __init__() \u662f\u81ea\u5b9a\u4e49 self \u7684\u5c5e\u6027\u6216\u65b9\u6cd5\uff0c</span>\n    <span class=\"pl-c\"># \u56e0\u6b64 as_view() \u5b9e\u9645\u4e0a\u662f\u5141\u8bb8\u6211\u4eec</span>\n    <span class=\"pl-c\"># \u8986\u76d6 View \u5bf9\u8c61\u539f\u6709\u7684\u5c5e\u6027\u548c\u65b9\u6cd5\uff08\u9664\u4e86\u5904\u7406\u8bf7\u6c42\u90a3\u90e8\u5206\uff09\u3002</span>\n\n    <span class=\"pl-k\">def</span> <span class=\"pl-en\">view</span>(<span class=\"pl-s1\">request</span>, <span class=\"pl-c1\">*</span><span class=\"pl-s1\">args</span>, <span class=\"pl-c1\">**</span><span class=\"pl-s1\">kwargs</span>):\n        <span class=\"pl-s1\">self</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">cls</span>(<span class=\"pl-c1\">**</span><span class=\"pl-s1\">initkwargs</span>)\n        <span class=\"pl-s1\">self</span>.<span class=\"pl-en\">setup</span>(<span class=\"pl-s1\">request</span>, <span class=\"pl-c1\">*</span><span class=\"pl-s1\">args</span>, <span class=\"pl-c1\">**</span><span class=\"pl-s1\">kwargs</span>)\n        <span class=\"pl-k\">if</span> <span class=\"pl-c1\">not</span> <span class=\"pl-en\">hasattr</span>(<span class=\"pl-s1\">self</span>, <span class=\"pl-s\">'request'</span>):\n            <span class=\"pl-k\">raise</span> <span class=\"pl-v\">AttributeError</span>()\n        <span class=\"pl-k\">return</span> <span class=\"pl-s1\">self</span>.<span class=\"pl-en\">dispatch</span>(<span class=\"pl-s1\">request</span>, <span class=\"pl-c1\">*</span><span class=\"pl-s1\">args</span>, <span class=\"pl-c1\">**</span><span class=\"pl-s1\">kwargs</span>)\n\n    <span class=\"pl-s1\">view</span>.<span class=\"pl-s1\">view_class</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">cls</span>\n    <span class=\"pl-s1\">view</span>.<span class=\"pl-s1\">view_initkwargs</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">initkwargs</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-s1\">view</span></pre></div>\n<p>\u800c <code>APIView</code> \u7684 <code>as_view()</code> \u9664\u4e86\u8981\u6c42 <strong>\u89c6\u56fe\u7c7b</strong> \u4e0d\u80fd\u76f4\u63a5\u5b58\u50a8\u67e5\u8be2\u96c6\u4e4b\u5916\uff0c\u4e5f\u4ec5\u4ec5\u5145\u5f53\u4e00\u4e2a\u57fa\u7c7b\u7684\u4f5c\u7528\uff0c\u5e76\u6ca1\u6709\u6dfb\u52a0\u4ec0\u4e48\u4e1c\u897f\u3002</p>\n<p>\u4ee3\u7801\u5927\u81f4\u5982\u4e0b\uff1a</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-c\"># \u7701\u7565\u4e86\u5f88\u591a\u7ec6\u8282...</span>\n<span class=\"pl-en\">@<span class=\"pl-s1\">classmethod</span></span>\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">as_view</span>(<span class=\"pl-s1\">cls</span>, <span class=\"pl-c1\">**</span><span class=\"pl-s1\">initkwargs</span>):\n\n    <span class=\"pl-s1\">view</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">super</span>().<span class=\"pl-en\">as_view</span>(<span class=\"pl-c1\">**</span><span class=\"pl-s1\">initkwargs</span>)\n    <span class=\"pl-s1\">view</span>.<span class=\"pl-s1\">cls</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">cls</span>\n    <span class=\"pl-s1\">view</span>.<span class=\"pl-s1\">initkwargs</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">initkwargs</span>\n\n    <span class=\"pl-c\"># \u5bf9\u57fa\u4e8e\u4f1a\u8bdd\u7684\u8eab\u4efd\u9a8c\u8bc1\u8fdb\u884cCSRF\u6821\u9a8c\u3002</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-en\">csrf_exempt</span>(<span class=\"pl-s1\">view</span>)</pre></div>\n<p><code>ViewSetMixin</code> \u5141\u8bb8\u4e00\u4e2a\u89c6\u56fe\u7c7b\u5904\u7406\u591a\u4e2a\u540c\u79cdHTTP\u8bf7\u6c42\uff0c\u6bd4\u5982\u5217\u8868\u7684GET\u548c\u8be6\u60c5\u7684GET\u5206\u522b\u8f6c\u53d1\u5230\u81ea\u5b9a\u4e49\u7684 <code>.list()</code> \u548c <code>retrieve()</code> \u3002</p>\n<p>\u7a76\u5176\u539f\u56e0\u662f\u5728 <code>MeowViewSet.as_view()</code> \u65f6\u5c06 <code>MeowViewSet</code> \u5bf9\u8c61\u7684 <code>list</code> \u590d\u5236\u5230\u4e86 <code>get</code> \u4e0a\uff0c\u5bfc\u81f4\u867d\u7136 <code>.dispatch()</code> \u867d\u7136\u8fd8\u662f\u673a\u68b0\u5730\u8f6c\u53d1GET\u8bf7\u6c42\u5230 <code>.get()</code> \u3001POST\u8bf7\u6c42\u5230 <code>.post()</code> \u2026\u2026\uff0c\u4f46\u6b64\u65f6\u8c03\u7528\u7684 <code>.get()</code> \u5b9e\u9645\u4e0a\u5c31\u662f <code>.list()</code> \uff0c\u6545\u800c\u53ea\u8981\u521b\u5efa\u4e0d\u540c\u7684 <code>MeowViewSet</code> \u5bf9\u8c61\u5c31\u80fd\u5b9e\u73b0\u4e00\u53e5\u4ee3\u7801\u5206\u522b\u5904\u7406\u5217\u8868\u7684GET\u548c\u8be6\u60c5\u7684GET\u3002</p>\n<p>\u4ee3\u7801\u5927\u81f4\u5982\u4e0b\uff1a</p>\n<div class=\"highlight highlight-source-python\"><pre><span class=\"pl-c\"># \u7701\u7565\u4e86\u5f88\u591a\u7ec6\u8282...</span>\n<span class=\"pl-en\">@<span class=\"pl-s1\">classonlymethod</span></span>\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">as_view</span>(<span class=\"pl-s1\">cls</span>, <span class=\"pl-s1\">actions</span><span class=\"pl-c1\">=</span><span class=\"pl-c1\">None</span>, <span class=\"pl-c1\">**</span><span class=\"pl-s1\">initkwargs</span>):\n\n    <span class=\"pl-k\">def</span> <span class=\"pl-en\">view</span>(<span class=\"pl-s1\">request</span>, <span class=\"pl-c1\">*</span><span class=\"pl-s1\">args</span>, <span class=\"pl-c1\">**</span><span class=\"pl-s1\">kwargs</span>):\n        <span class=\"pl-s1\">self</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">cls</span>(<span class=\"pl-c1\">**</span><span class=\"pl-s1\">initkwargs</span>)\n\n        <span class=\"pl-k\">if</span> <span class=\"pl-s\">'get'</span> <span class=\"pl-c1\">in</span> <span class=\"pl-s1\">actions</span> <span class=\"pl-c1\">and</span> <span class=\"pl-s\">'head'</span> <span class=\"pl-c1\">not</span> <span class=\"pl-c1\">in</span> <span class=\"pl-s1\">actions</span>:\n            <span class=\"pl-s1\">actions</span>[<span class=\"pl-s\">'head'</span>] <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">actions</span>[<span class=\"pl-s\">'get'</span>]\n\n        <span class=\"pl-c\"># \u4ece\u8fd9\u91cc\u53ef\u4ee5\u770b\u51fa\u6765\uff0c</span>\n        <span class=\"pl-c\"># actions \u7684\u952e\u662f HTTP \u65b9\u6cd5\u540d\uff0c\u503c\u5219\u662f\u5df2\u7ecf\u5b58\u5728\u7684\u65b9\u6cd5\u7684\u65b9\u6cd5\u540d\u3002</span>\n        <span class=\"pl-s1\">self</span>.<span class=\"pl-s1\">action_map</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">actions</span>\n        <span class=\"pl-k\">for</span> <span class=\"pl-s1\">method</span>, <span class=\"pl-s1\">action</span> <span class=\"pl-c1\">in</span> <span class=\"pl-s1\">actions</span>.<span class=\"pl-en\">items</span>():\n            <span class=\"pl-s1\">handler</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">getattr</span>(<span class=\"pl-s1\">self</span>, <span class=\"pl-s1\">action</span>)\n            <span class=\"pl-en\">setattr</span>(<span class=\"pl-s1\">self</span>, <span class=\"pl-s1\">method</span>, <span class=\"pl-s1\">handler</span>)\n\n        <span class=\"pl-c\"># 3.14.0 \u7684\u7248\u672c\u4f9d\u7136\u6709\u8fd9\u6bb5\u4ee3\u7801\uff0c</span>\n        <span class=\"pl-c\"># \u611f\u89c9\u8c8c\u4f3c\u662f\u8ddf dispatch() \u91cc\u7684\u91cd\u590d\u4e86\u3002</span>\n        <span class=\"pl-s1\">self</span>.<span class=\"pl-s1\">request</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">request</span>\n        <span class=\"pl-s1\">self</span>.<span class=\"pl-s1\">args</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">args</span>\n        <span class=\"pl-s1\">self</span>.<span class=\"pl-s1\">kwargs</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">kwargs</span>\n\n        <span class=\"pl-k\">return</span> <span class=\"pl-s1\">self</span>.<span class=\"pl-en\">dispatch</span>(<span class=\"pl-s1\">request</span>, <span class=\"pl-c1\">*</span><span class=\"pl-s1\">args</span>, <span class=\"pl-c1\">**</span><span class=\"pl-s1\">kwargs</span>)\n\n    <span class=\"pl-s1\">view</span>.<span class=\"pl-s1\">cls</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">cls</span>\n    <span class=\"pl-s1\">view</span>.<span class=\"pl-s1\">initkwargs</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">initkwargs</span>\n    <span class=\"pl-s1\">view</span>.<span class=\"pl-s1\">actions</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">actions</span>\n    <span class=\"pl-k\">return</span> <span class=\"pl-en\">csrf_exempt</span>(<span class=\"pl-s1\">view</span>)</pre></div>\n", "title": "\u7839\u5c0f\u7ffc", "homeUrl": "httpa://github.com/aixcyi/", "postSourceUrl": "https://github.com/aixcyi/aixcyi.github.io/issues/2", "faviconUrl": "https://avatars.githubusercontent.com/u/75880483", "filingNum": "", "startSite": "08/07/2023", "i18n": "CN", "commentNum": 0, "repoName": "aixcyi/aixcyi.github.io", "GMEEK_VERSION": "v1.2"}</script>
<body>
<div class="markdown-body">
    <h1>
        <div id="postTitle"></div>
        <div class="title-right">
        <button id="buttonHome" class="btn btn-invisible circle" onclick="window.location.href='/'"><svg class="octicon octicon-sun" width="16" height="16"><path id="pathHome" fill-rule="evenodd"></path></svg></button>
        
        <button class="btn btn-invisible circle" onclick="gotoSource()" title="Issue"><svg class="octicon octicon-sun" width="16" height="16"><path id="pathIssue" fill-rule="evenodd"></path></svg></button>
        
        <button id="changeTheme" class="btn btn-invisible circle" onclick="modeSwitch()"><svg class="octicon octicon-sun" width="16" height="16"><path id="themeSwitch" fill-rule="evenodd"></path></svg></button>
        </div>
    </h1>
    <div id="postBody"></div>

    <button class="btn btn-block" type="button" onclick="openComments()" id="cmButton"> </button>
    <div class="comments" id="comments"></div>

    <div class="footer">Copyright © <span id="year"></span> <a id="footerblogTitle" href=""></a> <p><span id="filingNum"></span><span id="runday"></span>Powered by <a href="https://github.com/Meekdai/Gmeek" target="_blank">Gmeek</a></p></div>
</div>
</body>

<script>
function addScript(url){
    var script = document.createElement('script');
    script.setAttribute('type','text/javascript');
    script.setAttribute('src',url);
    document.body.appendChild(script);
}
window.onload=function(){
    addScript("https://cdn.jsdelivr.net/gh/Meekdai/Gmeek@"+blogBase["GMEEK_VERSION"]+"/icon.js" );
    addScript("https://cdn.jsdelivr.net/gh/Meekdai/Gmeek@"+blogBase["GMEEK_VERSION"]+"/Gmeek.js" );
}
</script>

</html>
